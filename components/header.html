<header class="home-header fixed-top d-flex align-items-center">
  <div
    class="container-fluid px-4 d-flex justify-content-between align-items-center position-relative"
  >
    <!-- Logo và Menu Button -->
    <div class="d-flex align-items-center">
      <button
        class="btn border-0 text-white d-md-none me-3 p-0"
        id="menuToggle"
      >
        <i class="fa-solid fa-bars fs-4"></i>
      </button>

      <a
        href="/index.html"
        class="logo-link text-decoration-none d-flex align-items-center gap-2"
      >
        <img src="/assets/images/VitaFlix.png" alt="Logo" class="logo-img" />
        <h1 class="logo-text m-0">VitaFlix</h1>
      </a>
    </div>

    <!-- Desktop Navigation -->
    <nav
      class="d-none d-md-block position-absolute start-50 translate-middle-x"
    >
      <ul class="list-unstyled d-flex align-items-center gap-4 m-0">
        <li>
          <a href="#" class="nav-link-custom" data-page="home">Trang chủ</a>
        </li>
        <li>
          <a href="#" class="nav-link-custom" data-page="category">Chủ đề</a>
        </li>
        <li>
          <a href="#" class="nav-link-custom" data-page="genre">Thể loại</a>
        </li>
        <li class="has-dropdown" data-list-type="series">
          <a href="#" class="nav-link-custom" data-filter="series"
            >Phim Bộ <i class="fa-solid fa-caret-down"></i
          ></a>
          <div class="dropdown-content js-series-dropdown">
            <p class="dropdown-title">Phim Bộ Nổi Bật</p>
            <div class="dropdown-list"></div>
            <a href="#" class="dropdown-more filter-btn" data-filter="series"
              >Xem Thêm Phim Bộ...</a
            >
          </div>
        </li>

        <li class="has-dropdown" data-list-type="single">
          <a href="#" class="nav-link-custom" data-filter="single"
            >Phim Lẻ <i class="fa-solid fa-caret-down"></i
          ></a>
          <div class="dropdown-content js-single-dropdown">
            <p class="dropdown-title">Phim Lẻ Nổi Bật</p>
            <div class="dropdown-list"></div>
            <a href="#" class="dropdown-more filter-btn" data-filter="single"
              >Xem Thêm Phim Lẻ...</a
            >
          </div>
        </li>
        <li>
          <a href="#" class="nav-link-custom" data-page="country">Quốc gia</a>
        </li>
      </ul>
    </nav>

    <!-- Search và User Profile -->
    <div class="d-flex align-items-center gap-3">
      <div class="search-box d-none d-sm-flex align-items-center">
        <input
          type="text"
          class="form-control shadow-none"
          placeholder="Tìm kiếm..."
        />
        <i class="fa-solid fa-magnifying-glass text-white pe-3"></i>
      </div>

      <i
        class="fa-solid fa-magnifying-glass d-sm-none fs-5 cursor-pointer text-white"
      ></i>

      <div class="user-profile">
        <i class="fa-solid fa-user fs-5 text-white"></i>
      </div>
    </div>
  </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="logo-text m-0">VitaFlix</h3>
    <button class="btn text-white border-0" id="closeMobileMenu">
      <i class="fa-solid fa-xmark fs-4"></i>
    </button>
  </div>
  <ul class="list-unstyled d-flex flex-column gap-3">
    <li>
      <a
        href="#"
        class="text-white text-decoration-none fs-5 mobile-nav-link"
        data-page="home"
      >
        <i class="fa-solid fa-house me-2"></i> Trang chủ
      </a>
    </li>
    <li>
      <a
        href="#"
        class="text-white-50 text-decoration-none fs-5 mobile-nav-link"
        data-page="category"
      >
        Chủ đề
      </a>
    </li>
    <li>
      <a
        href="#"
        class="text-white-50 text-decoration-none fs-5 mobile-nav-link"
        data-page="genre"
      >
        Thể loại
      </a>
    </li>
    <li>
      <a
        href="#"
        class="text-white-50 text-decoration-none fs-5 mobile-nav-link"
        data-page="single"
      >
        Phim lẻ
      </a>
    </li>
    <li>
      <a
        href="#"
        class="text-white-50 text-decoration-none fs-5 mobile-nav-link"
        data-page="series"
      >
        Phim bộ
      </a>
    </li>
    <li>
      <a
        href="#"
        class="text-white-50 text-decoration-none fs-5 mobile-nav-link"
        data-page="country"
      >
        Quốc gia
      </a>
    </li>
  </ul>
</div>
<div class="overlay"></div>

<script>
  // Mobile Menu Toggle
  const menuBtn = document.querySelector("#menuToggle");
  const mobileMenu = document.querySelector(".mobile-menu");
  const overlay = document.querySelector(".overlay");
  const closeMobileMenuBtn = document.querySelector("#closeMobileMenu");

  // Mở menu
  if (menuBtn) {
    menuBtn.addEventListener("click", () => {
      mobileMenu.classList.add("active");
      overlay.classList.add("active");
      document.body.style.overflow = "hidden";
    });
  }

  // Đóng menu khi click overlay
  if (overlay) {
    overlay.addEventListener("click", closeMenu);
  }

  // Đóng menu khi click nút X
  if (closeMobileMenuBtn) {
    closeMobileMenuBtn.addEventListener("click", closeMenu);
  }

  // Hàm đóng menu
  function closeMenu() {
    if (mobileMenu) mobileMenu.classList.remove("active");
    if (overlay) overlay.classList.remove("active");
    document.body.style.overflow = "";
  }

  // Xử lý navigation cho desktop và DROPDOWN LINKS
  document.querySelectorAll(".nav-link-custom").forEach((link) => {
    link.addEventListener("click", handleNavClick);
  });

  // Xử lý navigation cho mobile
  document.querySelectorAll(".mobile-nav-link").forEach((link) => {
    link.addEventListener("click", (e) => {
      handleNavClick(e);
      closeMenu();
    });
  });

  // Hàm xử lý click navigation
  function handleNavClick(e) {
    e.preventDefault();
    const page = e.currentTarget.dataset.page;

    // Remove active từ tất cả links
    document
      .querySelectorAll(".nav-link-custom, .mobile-nav-link")
      .forEach((l) => {
        l.classList.remove("active");
      });

    // Add active cho link được click
    // Kiểm tra xem link có phải là link trong dropdown không
    if (!e.currentTarget.classList.contains("dropdown-more")) {
      e.currentTarget.classList.add("active");
    }

    // Dispatch custom event để filter.js xử lý
    const event = new CustomEvent("navigationClick", {
      detail: { page: page },
    });
    window.dispatchEvent(event);
  }

  // Highlight active page khi load
  document.addEventListener("DOMContentLoaded", () => {
    const currentPath = window.location.pathname;
    if (currentPath === "/index.html" || currentPath === "/") {
      document.querySelectorAll('[data-page="home"]').forEach((link) => {
        link.classList.add("active");
      });
    }
  });
</script>
